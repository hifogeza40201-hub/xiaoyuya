# MCP协议实施路线图规划

> 基于第一轮MCP调研成果 | 制定者：Agent 2 | 适用企业：株洲微享科技有限公司

---

## 一、餐饮企业MCP Server架构图（文字描述版）

### 1.1 整体架构概览

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           【AI应用层】                                       │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │  智能客服    │  │  库存助手    │  │  数据分析师  │  │  管理驾驶舱  │        │
│  │  (订座/咨询) │  │  (采购预警)  │  │  (报表洞察)  │  │  (决策支持)  │        │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘        │
│         │                │                │                │               │
│         └────────────────┴────────────────┴────────────────┘               │
│                                    │                                        │
│                          【MCP Host层】                                     │
│                         (Claude Desktop /                                  │
│                          Claude API / 自研AI)                               │
│                                    │                                        │
└────────────────────────────────────┼────────────────────────────────────────┘
                                     │ JSON-RPC 2.0
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         【MCP Client层】                                    │
│         ┌─────────────────────────────────────────────────────┐             │
│         │         OpenClaw Gateway (端口: 18792)               │             │
│         │         - 认证与权限控制                              │             │
│         │         - 连接管理                                    │             │
│         └─────────────────────────────────────────────────────┘             │
└────────────────────────────────────┼────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         【MCP Server集群层】                                 │
│                                                                             │
│  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐          │
│  │  天财商龙MCP     │  │  库存管理MCP     │  │  CRM会员MCP      │          │
│  │    Server        │  │    Server        │  │    Server        │          │
│  ├──────────────────┤  ├──────────────────┤  ├──────────────────┤          │
│  │ • 订单查询       │  │ • 库存查询       │  │ • 会员查询       │          │
│  │ • 营业数据       │  │ • 采购建议       │  │ • 消费记录       │          │
│  │ • 报表生成       │  │ • 预警推送       │  │ • 偏好分析       │          │
│  └────────┬─────────┘  └────────┬─────────┘  └────────┬─────────┘          │
│           │                     │                     │                     │
│  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐          │
│  │  供应链MCP       │  │  财务对账MCP     │  │  人事考勤MCP     │          │
│  │    Server        │  │    Server        │  │    Server        │          │
│  ├──────────────────┤  ├──────────────────┤  ├──────────────────┤          │
│  │ • 供应商管理     │  │ • 收支明细       │  │ • 排班查询       │          │
│  │ • 价格比对       │  │ • 成本核算       │  │ • 考勤统计       │          │
│  │ • 合同管理       │  │ • 利润分析       │  │ • 薪资计算       │          │
│  └──────────────────┘  └──────────────────┘  └──────────────────┘          │
└─────────────────────────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         【企业系统层】                                       │
│                                                                             │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐       │
│  │  天财商龙    │ │   库存ERP    │ │   会员CRM    │ │   财务系统   │       │
│  │   POS系统    │ │   管理系统   │ │   系统       │ │              │       │
│  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘       │
│                                                                             │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐       │
│  │   供应链     │ │   人事HR     │ │   钉钉OA     │ │   数据仓库   │       │
│  │   系统       │ │   系统       │ │              │ │   (数仓)     │       │
│  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘       │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 核心MCP Server功能详解

#### 1.2.1 天财商龙MCP Server
| 工具名称 | 功能描述 | 调用方式 |
|---------|---------|---------|
| `get_daily_sales` | 获取指定日期门店营业额 | 参数: date, store_id |
| `get_order_details` | 查询订单明细 | 参数: order_id |
| `get_dish_ranking` | 获取菜品销售排行 | 参数: start_date, end_date, top_n |
| `generate_report` | 生成经营报表 | 参数: report_type, period |
| `get_table_status` | 查询桌台状态 | 参数: store_id |

#### 1.2.2 库存管理MCP Server
| 工具名称 | 功能描述 | 调用方式 |
|---------|---------|---------|
| `get_inventory` | 查询当前库存 | 参数: material_id, store_id |
| `check_expiry` | 检查临期食材 | 参数: days_threshold |
| `predict_consumption` | 预测食材消耗 | 参数: material_id, days |
| `generate_purchase_order` | 生成采购建议单 | 参数: store_id, auto_submit |
| `alert_low_stock` | 低库存预警 | 参数: threshold_percent |

#### 1.2.3 智能客服MCP Server
| 工具名称 | 功能描述 | 调用方式 |
|---------|---------|---------|
| `check_availability` | 查询可预订时段 | 参数: date, people_count, store_id |
| `make_reservation` | 创建预订 | 参数: customer_name, phone, datetime, people |
| `cancel_reservation` | 取消预订 | 参数: reservation_id |
| `get_customer_history` | 查询客户历史 | 参数: phone_number |
| `record_preference` | 记录客户偏好 | 参数: phone, preference_type, value |

---

## 二、资源清单

### 2.1 人力资源需求

| 角色 | 人数 | 技能要求 | 投入周期 | 备注 |
|-----|------|---------|---------|------|
| **项目经理** | 1人 | 熟悉餐饮行业、项目管理经验 | 全程 | 内部调配 |
| **后端开发工程师** | 2人 | Python/Node.js, API开发 | 全程 | 可外包1人 |
| **AI工程师** | 1人 | 大模型应用、Prompt工程 | 2-10月 | 建议招聘 |
| **系统对接工程师** | 1人 | 熟悉天财商龙API | 3-8月 | 内部培养 |
| **测试工程师** | 1人 | 自动化测试、安全测试 | 4-12月 | 可兼职 |
| **运维工程师** | 1人 | 服务器运维、监控 | 6-12月 | 内部兼任 |
| **业务顾问** | 1人 | 门店运营、业务流程 | 需求阶段 | 店长兼任 |

**总计人力需求**: 8人（核心团队5人 + 兼职/兼任3人）

### 2.2 时间投入估算

| 阶段 | 周期 | 人月投入 | 主要工作 |
|-----|------|---------|---------|
| **准备期** | 1个月 | 4人月 | 需求调研、技术选型、环境搭建 |
| **第一阶段** | 3个月 | 12人月 | 智能客服MCP Server开发 |
| **第二阶段** | 3个月 | 12人月 | 库存管理MCP Server开发 |
| **第三阶段** | 4个月 | 16人月 | 数据分析MCP + 系统集成 |
| **试运行期** | 2个月 | 6人月 | 试点门店、优化迭代 |
| **总计** | **13个月** | **50人月** | - |

### 2.3 预算成本估算

#### 2.3.1 人力成本

| 角色 | 月薪(元) | 投入月数 | 小计(元) |
|-----|---------|---------|---------|
| 项目经理 | 15,000 | 13 | 195,000 |
| 后端工程师A | 18,000 | 13 | 234,000 |
| 后端工程师B(外包) | 12,000 | 10 | 120,000 |
| AI工程师 | 25,000 | 8 | 200,000 |
| 系统对接工程师 | 16,000 | 6 | 96,000 |
| 测试工程师(兼职50%) | 8,000 | 9 | 72,000 |
| 运维工程师(兼任20%) | 3,000 | 7 | 21,000 |
| **人力成本合计** | - | - | **938,000** |

#### 2.3.2 基础设施成本

| 项目 | 配置 | 月费用 | 年费用 |
|-----|------|-------|-------|
| 云服务器(生产) | 4核8G × 2台 | 800元 | 9,600元 |
| 云服务器(测试) | 2核4G × 1台 | 200元 | 2,400元 |
| 数据库RDS | MySQL 4核8G | 600元 | 7,200元 |
| 对象存储OSS | 500GB | 50元 | 600元 |
| 负载均衡SLB | 标准型 | 100元 | 1,200元 |
| **基础设施年费用** | - | **1,750元/月** | **21,000元** |

#### 2.3.3 AI服务调用成本

| 服务 | 用量预估 | 单价 | 月费用 | 年费用 |
|-----|---------|------|-------|-------|
| Claude API | 50,000次/月 | $0.003/次 | ~1,050元 | 12,600元 |
| 天财商龙API | 100,000次/月 | 按现有合同 | 0元 | 0元 |
| 向量数据库 | 100万条记录 | 0.5元/千条 | 500元 | 6,000元 |
| **AI服务年费用** | - | - | **~1,550元/月** | **18,600元** |

#### 2.3.4 其他成本

| 项目 | 费用 | 说明 |
|-----|------|------|
| 开发工具/IDE授权 | 5,000元 | JetBrains全家桶等 |
| 代码托管/CI/CD | 3,000元 | GitHub Pro/GitLab |
| 监控告警系统 | 4,000元 | 阿里云监控、日志服务 |
| 安全渗透测试 | 10,000元 | 第三方安全公司 |
| 培训费用 | 8,000元 | 团队技术培训 |
| 应急储备金 | 50,000元 | 风险缓冲(5%) |
| **其他费用合计** | **80,000元** | - |

### 2.4 预算汇总

| 类别 | 第一年费用 | 第二年及以后(年) |
|-----|-----------|-----------------|
| 人力成本 | 938,000元 | 780,000元 |
| 基础设施 | 21,000元 | 21,000元 |
| AI服务 | 18,600元 | 36,000元(增长) |
| 其他费用 | 80,000元 | 30,000元 |
| **总计** | **1,057,600元** | **867,000元** |

> **投资回报预估**: 
> - 第一年: 节约人力成本 150,000元 + 降低损耗 80,000元 = 230,000元
> - 第二年: 年化收益预计 400,000-500,000元
> - **投资回收期**: 约2.5年

---

## 三、甘特图时间表（关键里程碑）

### 3.1 整体时间线（13个月）

```
月份:  1   2   3   4   5   6   7   8   9   10  11  12  13
      ├───────┼───────┼───────┼───────┼───────┼───────┼───────┤
      │ 准备期 │    第一阶段(智能客服)   │ 第二阶段(库存) │ 第三阶段 │ 试运行 │
      └───────┴───────────────────────┴───────────────┴──────────┴────────┘
```

### 3.2 详细里程碑规划

```
【准备期】第1-4周
├─ Week 1-2: 项目启动
│   ├─ □ 成立项目团队
│   ├─ □ 需求调研与访谈(3家门店)
│   └─ □ 技术选型确认
├─ Week 3-4: 环境搭建
│   ├─ □ 开发环境配置
│   ├─ □ 代码仓库初始化
│   └─ □ 天财商龙API文档获取
└─ 🔶 M1: 项目启动完成 (Month 1 End)

【第一阶段】Month 2-4: 智能客服MCP Server
├─ Month 2: 基础开发
│   ├─ Week 5-6: MCP Server框架搭建
│   ├─ Week 7-8: 天财商龙API对接(桌台查询)
│   └─ □ 订座查询工具开发
├─ Month 3: 功能完善
│   ├─ Week 9-10: 预订/取消功能开发
│   ├─ Week 11-12: CRM会员数据对接
│   └─ □ 客户偏好记录功能
├─ Month 4: 集成测试
│   ├─ Week 13: AI提示模板优化
│   ├─ Week 14: 单元测试与集成测试
│   ├─ Week 15: 安全测试
│   └─ Week 16: 小范围内部试用
└─ 🔶 M2: 智能客服MCP上线 (Month 4 End)

【第二阶段】Month 5-7: 库存管理MCP Server
├─ Month 5: 核心功能
│   ├─ Week 17-18: 库存管理MCP框架
│   ├─ Week 19-20: 库存查询与预警
│   └─ □ 临期食材检查功能
├─ Month 6: 智能预测
│   ├─ Week 21-22: 消耗预测算法
│   ├─ Week 23-24: 采购建议生成
│   └─ □ 供应商价格比对
├─ Month 7: 测试优化
│   ├─ Week 25-26: 试点门店部署
│   ├─ Week 27-28: 用户反馈收集优化
│   └─ □ 操作手册编写
└─ 🔶 M3: 库存管理MCP上线 (Month 7 End)

【第三阶段】Month 8-11: 数据分析MCP + 系统集成
├─ Month 8: 数据分析MCP
│   ├─ Week 29-30: 数据仓库对接
│   ├─ Week 31-32: 报表生成工具
│   └─ □ 经营指标自然语言查询
├─ Month 9: 扩展功能
│   ├─ Week 33-34: 菜品毛利分析
│   ├─ Week 35-36: 智能推荐引擎
│   └─ □ 新品定价建议
├─ Month 10: 系统集成
│   ├─ Week 37-38: MCP Server集群化管理
│   ├─ Week 39-40: 统一认证与权限
│   └─ □ 监控告警系统
├─ Month 11: 管理驾驶舱
│   ├─ Week 41-42: 可视化看板开发
│   ├─ Week 43-44: 移动端适配
│   └─ □ 决策建议功能
└─ 🔶 M4: 完整MCP平台上线 (Month 11 End)

【试运行期】Month 12-13: 全面推广
├─ Month 12: 试点运行
│   ├─ Week 45-46: 3家门店全面试点
│   ├─ Week 47-48: 数据收集与问题修复
│   └─ □ 用户培训(店长+员工)
├─ Month 13: 优化推广
│   ├─ Week 49-50: 系统性能优化
│   ├─ Week 51-52: 推广至全部门店
│   └─ □ 项目总结与规划V2
└─ 🔶 M5: 项目验收完成 (Month 13 End)
```

### 3.3 关键里程碑汇总

| 里程碑 | 时间节点 | 交付物 | 验收标准 |
|-------|---------|-------|---------|
| **M1** | 第1月末 | 项目启动完成 | 团队组建完成、环境就绪 |
| **M2** | 第4月末 | 智能客服MCP V1.0 | 支持订座查询/预订、客服响应准确率>85% |
| **M3** | 第7月末 | 库存管理MCP V1.0 | 库存预警准确率>90%、采购建议采纳率>60% |
| **M4** | 第11月末 | MCP平台 V1.0 | 6大Server全部上线、系统稳定运行 |
| **M5** | 第13月末 | 项目验收 | 全部门店上线、ROI达成预期 |

### 3.4 3/6/12个月目标对照

| 时间节点 | 目标 | 关键成果 |
|---------|------|---------|
| **3个月** | PoC验证 | 智能客服MCP上线、1家门店试点、订座转化率提升20% |
| **6个月** | 核心场景覆盖 | 库存+客服双场景、3家门店推广、人效提升15% |
| **12个月** | 全面数字化 | 完整MCP平台、全部门店覆盖、年度ROI转正 |

---

## 四、风险清单与应对方案

### 4.1 技术风险

| 风险编号 | 风险描述 | 可能性 | 影响度 | 风险等级 |
|---------|---------|-------|-------|---------|
| T-R01 | 天财商龙API接口不稳定/文档不全 | 中 | 高 | 🔴 高 |
| T-R02 | MCP协议版本迭代导致兼容性问题 | 中 | 中 | 🟡 中 |
| T-R03 | AI模型幻觉导致业务数据错误 | 中 | 高 | 🔴 高 |
| T-R04 | 系统性能瓶颈(高并发下响应慢) | 低 | 中 | 🟡 中 |
| T-R05 | 数据同步延迟导致决策失误 | 中 | 高 | 🔴 高 |

#### 应对方案

**T-R01: API接口不稳定**
- **预防措施**: 
  - 签约前与商龙技术团队深度沟通，确认API能力边界
  - 开发Mock服务用于测试环境
- **应急方案**: 
  - 建立本地数据缓存机制，API故障时降级运行
  - 准备备用数据源(手工导入Excel)
- **责任人**: 系统对接工程师
- **触发条件**: API响应失败率>5%

**T-R03: AI模型幻觉**
- **预防措施**:
  - 设计严格的工具调用校验机制
  - 关键操作(如采购单提交)必须人工确认
  - 建立数据一致性检查规则
- **应急方案**:
  - 启用只读模式，暂停AI写入操作
  - 回滚至上一版本
- **责任人**: AI工程师
- **触发条件**: 发现3次以上AI提供错误数据

**T-R05: 数据同步延迟**
- **预防措施**:
  - 设计实时+定时双通道同步机制
  - 设置数据新鲜度告警(超过5分钟未更新)
- **应急方案**:
  - 切换到直连数据库模式(绕过API)
  - 显示数据最后更新时间，提醒用户
- **责任人**: 后端开发工程师

### 4.2 业务风险

| 风险编号 | 风险描述 | 可能性 | 影响度 | 风险等级 |
|---------|---------|-------|-------|---------|
| B-R01 | 门店员工抵触新系统，使用率低 | 高 | 中 | 🟡 中 |
| B-R02 | AI建议不被信任，决策仍依赖经验 | 中 | 中 | 🟡 中 |
| B-R03 | 业务流程变更导致客户体验下降 | 低 | 高 | 🟡 中 |
| B-R04 | 关键岗位人员离职，知识流失 | 中 | 中 | 🟡 中 |

#### 应对方案

**B-R01: 员工抵触**
- **预防措施**:
  - 设计极简交互，减少学习成本
  - 试点选择积极配合的门店
  - 设置使用激励(与绩效挂钩)
- **应急方案**:
  - 保留原系统并行运行1个月
  - 增加现场培训次数
- **责任人**: 项目经理 + 业务顾问

**B-R02: 信任问题**
- **预防措施**:
  - AI建议必须附带数据依据
  - 建立"建议采纳率"追踪，持续优化算法
  - 让管理层先用起来，树立榜样
- **应急方案**:
  - 增加人工复核环节
  - 调整AI建议的置信度阈值
- **责任人**: 项目经理

### 4.3 安全风险

| 风险编号 | 风险描述 | 可能性 | 影响度 | 风险等级 |
|---------|---------|-------|-------|---------|
| S-R01 | 核心经营数据泄露 | 低 | 极高 | 🔴 高 |
| S-R02 | AI被诱导执行恶意操作 | 中 | 高 | 🔴 高 |
| S-R03 | API密钥泄露/滥用 | 中 | 高 | 🔴 高 |
| S-R04 | 未经授权的数据访问 | 中 | 高 | 🔴 高 |

#### 应对方案

**S-R01: 数据泄露**
- **预防措施**:
  - 敏感数据(客户手机号)脱敏处理
  - 数据库访问IP白名单
  - 数据传输TLS加密
  - 定期进行安全审计
- **应急方案**:
  - 立即下线相关服务
  - 启动数据泄露响应预案
  - 48小时内向监管部门报告
- **责任人**: 运维工程师 + 项目经理

**S-R02: AI诱导攻击**
- **预防措施**:
  - 实施严格的权限控制(只读/读写分离)
  - 危险操作(如批量删除)必须多因素认证
  - 建立AI操作审计日志
- **应急方案**:
  - 冻结AI账户
  - 回滚被篡改的数据
- **责任人**: AI工程师 + 运维工程师

**S-R03: API密钥泄露**
- **预防措施**:
  - 密钥存储在KMS(密钥管理服务)
  - 定期轮换密钥(90天)
  - 监控API调用异常模式
- **应急方案**:
  - 立即吊销泄露密钥
  - 生成新密钥并更新配置
- **责任人**: 运维工程师

### 4.4 成本与进度风险

| 风险编号 | 风险描述 | 可能性 | 影响度 | 风险等级 |
|---------|---------|-------|-------|---------|
| C-R01 | 开发进度延期(需求变更) | 高 | 中 | 🟡 中 |
| C-R02 | AI调用成本超预期 | 中 | 中 | 🟡 中 |
| C-R03 | 关键人员离职 | 中 | 高 | 🔴 高 |

#### 应对方案

**C-R01: 进度延期**
- **预防措施**:
  - 采用敏捷开发，每2周迭代
  - 需求变更必须经过CCB(变更控制委员会)
  - 预留20%缓冲时间
- **应急方案**:
  - 裁剪非核心功能至V2
  - 增加外包资源
- **责任人**: 项目经理

**C-R02: 成本超支**
- **预防措施**:
  - 设置API调用量告警(达到80%预警)
  - 优化Prompt减少Token消耗
  - 引入缓存减少重复调用
- **应急方案**:
  - 切换至成本更低的模型(GPT-3.5)
  - 限制非核心功能的AI调用频率
- **责任人**: AI工程师

**C-R03: 人员离职**
- **预防措施**:
  - 建立知识库，文档化所有设计决策
  - 代码审查制度，确保多人熟悉核心代码
  - 关键岗位设置AB角
- **应急方案**:
  - 启动紧急招聘
  - 调整项目计划，优先保证核心功能
- **责任人**: 项目经理

### 4.5 风险矩阵汇总

```
影响度
  极高 │                              S-R01
       │                    
    高 │  T-R01 T-R03    S-R02 S-R03 S-R04    C-R03
       │              T-R05
    中 │  B-R01        T-R02 T-R04    B-R02 B-R04    C-R01 C-R02
       │                            
    低 │  
       └────────────────────────────────────────────────────────────
         低        中        高                    极高
                    可能性
         
图例: 🔴 高优先级  🟡 中优先级  🟢 低优先级
```

---

## 五、实施成功关键因素

### 5.1 组织保障

| 因素 | 说明 | 行动 |
|-----|------|------|
| 高层支持 | 需要CEO/CTO级别的支持 | 每月项目汇报，获取资源保障 |
| 业务主导 | IT与业务部门紧密协作 | 业务顾问全程参与需求评审 |
| 试点先行 | 选择积极配合的门店 | 1-2家标杆门店，打造成功案例 |

### 5.2 技术保障

| 因素 | 说明 | 行动 |
|-----|------|------|
| 稳定API | 天财商龙API是核心依赖 | 提前与商龙签订技术支持协议 |
| 监控告警 | 系统健康度实时可见 | 建立完善的监控体系 |
| 灰度发布 | 新功能逐步放开 | 使用Feature Flag控制功能开关 |

### 5.3 运营保障

| 因素 | 说明 | 行动 |
|-----|------|------|
| 培训体系 | 确保员工会用、愿用 | 制作视频教程、FAQ文档 |
| 反馈闭环 | 持续收集优化建议 | 每月用户满意度调查 |
| 激励机制 | 推动主动使用 | 将AI建议采纳率纳入店长KPI |

---

## 六、附录

### 6.1 参考资源

- [MCP官方文档](https://modelcontextprotocol.io/)
- [MCP Python SDK](https://github.com/modelcontextprotocol/python-sdk)
- [MCP TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)
- [Anthropic MCP示例](https://github.com/modelcontextprotocol/servers)

### 6.2 术语表

| 术语 | 说明 |
|-----|------|
| MCP | Model Context Protocol，模型上下文协议 |
| MCP Server | 提供数据/工具能力的服务端程序 |
| MCP Client | 与Server建立连接的客户端 |
| MCP Host | 运行AI模型的宿主应用 |
| JSON-RPC | 远程过程调用协议，MCP通信基础 |
| PoC | Proof of Concept，概念验证 |
| MVP | Minimum Viable Product，最小可行产品 |

### 6.3 文档修订记录

| 版本 | 日期 | 修订内容 | 作者 |
|-----|------|---------|------|
| v1.0 | 2026-02-14 | 初始版本 | Agent 2 |

---

*本文档为MCP协议在餐饮企业的实施路线图规划，基于第一轮MCP调研成果编制。*
